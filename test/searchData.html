<html>

<head>
  <meta charset="UTF-8">

  <style>
    body {
      padding: 20px;
    }
  </style>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/css/bootstrap.min.css" rel="stylesheet"
    integrity="sha384-gH2yIJqKdNHPEq0n4Mqa/HGKIhSkIHeL5AyhkYV8i59U5AR6csBvApHHNl/vI1Bx" crossorigin="anonymous">

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0/dist/js/bootstrap.bundle.min.js"
    integrity="sha384-A3rJD856KowSb7dwlZdYEkO39Gagi7vIsF0jrRAoQmDKKtQBHUuLZ9AsSv4jD4Xa"
    crossorigin="anonymous"></script>

  <script>

    function showHint(user, email) {
      var xmlhttp;

      if (window.XMLHttpRequest) {
        xmlhttp = new XMLHttpRequest();
      }
      else {
        xmlhttp = new ActiveXObject("Microsoft.XMLHTTP");
      }
      xmlhttp.onreadystatechange = function () {
        if (xmlhttp.readyState == 4 && xmlhttp.status == 200) {
          var result = xmlhttp.responseText;
          var obj = JSON.parse(result);

          var html = '<table class="table table-hover align-middle">';

          html += '<thead class="table-secondary align-middle text-center">';
          html += '<tr>';
          for (var j = 0; j < obj[0].data.length; j++) {
            html += '<td>' + obj[0].data[j] + '</td>';
          }
          html += '</tr>';
          html += '</thead>';

          html += '<tbody>';
          for (var i = 1; i < obj.length; i++) {
            html += '<tr>';
            for (var j = 0; j < obj[i].data.length; j++) {
              html += '<td>' + obj[i].data[j] + '</td>';
            }
            html += '</tr>';
          }
          html += '</tbody></table>';

          if (obj.length == 1)
            html += '<div class="alert alert-danger text-center" role="alert">查無資料</div>';

          document.getElementById("order_status").innerHTML = html;

        }

      }
      // Google 試算表的部屬網址
      var url = "https://script.google.com/macros/s/AKfycbxhna9G88U0gpZAN6FSvm5j70FgO_sg_FzGMW6R6922rVlCP2MrXdcjlWbZ6ZfMNU8GGg/exec";
      // 傳入參數
      xmlhttp.open("get", url + "?user=" + user + "&email=" + email, true);
      xmlhttp.send();
    }
  </script>

</head>

<body>

  <div class="row g-3 input-group input-group-lg">
    <div class="col-md-6">
      <label class="form-label col-form-label-lg">姓名</label>
      <input type="text" class="form-control form-control-lg" id="user">
    </div>
    <div class="col-md-6">
      <label class="form-label col-form-label-lg">電子郵件</label>
      <input type="email" class="form-control form-control-lg" id="email">
    </div>
    <div class="col-12">
      <button type="submit" class="btn btn-outline-success btn-lg" style="float:right;"
        onclick="showHint(user.value,email.value);">開始查詢</button>
    </div>
  </div>

  <p></p>
  <span id="order_status"></span>

</body>

</html>